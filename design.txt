meute project aspects:
======================
* a showcase for:
  - unhosted web apps,
  - 5apps,
  - remoteStorage,
  - sockethub,
  - useraddress,
  - opentabs.
* an email client running in your browser, using sockethub
* stores your contacts and message history on either your remoteStorage or your GoogleDrive, using remotestorage.js
* support for xmpp, irc, facebook chat, and webrtc are also planned, using future sockethub platforms
* blogging and polyglot linkback, using future sockethub/welten/? functionality
* distributed identity, using useraddress + remoteStorage.contacts
* money without banks, using opentabs

data architecture:
==================
email/messages/ -> PrefixTree of messageId to JSON objects.
email/imap/[account]/[folder] -> map seqno -> messageId (hope there are no more than 10,000 msg in each folder)
inbox/ -> one PrefixTree per contactId of timestamp to msgId+read/unread+starred.
       -> maybe second index for unread, starred.
contacts/ -> PrefixTree of contactId to JSON objects.
          -> second index for full text search

when a message comes in from sockethub, add all contacts to:
* contacts/id/
* contacts/prefix/[abc]
add the full Activity to:
* email/messages/
and point to it from:
* email/imap/[account]/[folder]#seqno
* inbox/contact/[each contactId]/
* inbox/unread/ can then point to contactIds

ways in which meute breaks down when you try to deal with 5000 inbox msg:
=========================================================================
- it takes a long time to download headers over a flaky connection, although the current approach can store about 10 msg / second, so it would in theory complete in 9 minutes if uninterrupted. for just the headers, this is really slow, although it's only once.
- it is totally impossible to use sync with > 100 outgoing changes. it will fire 100 OPTIONS requests, they will all time out, and that was it.
- IndexedDB sometimes throws an UnknownError, and while storing messages, it turned out some just didn't get stored. disk I/O also got up to 40%.
- Firefox freezes and crashes, and page loads can trigger 1000 AbortErrors, which take a long time to scroll over the console.
- if incoming changes fail to fetch, they don't get retried.

possible workarounds:
=====================
- don't cache all email headers. just pass them through to the server, and build good indexes
- store much bigger objects in IndexedDB. instead of PrefixTree, use archive blocks and singles. if the singles add up to a reasonable archive block size, archive them.
- or only dump snapshots of the memory state into big IndexedDB items.
- keep track of how many sync actions are pending, and set a maximum.
- when pushing changes, mark the parent folder as dirty
- on local putDirectory, create the child items as dirty
- three sync phases: pushChanges, fetchDirties, checkRoot
- don't set the 'next' pointer, only the 'previous' pointer. that way activities is append-only and you don't need to write to the archive
- try this with PouchDB
- try this in Chrome and other browsers
- ask Dominic

plan:
=====
* develop with
  - meute on localhost:4242 (meute.lolcathost.de:4242 for GoogleDrive testing),
  - remoteStorage on 5apps,
  - sockethub on ws://162.242.174.14:10550, secret: '1234567890'
* try out email functionality with real data
* try out contacts functionality with real data
* use rs.js me/dev branch, included locally into alpha.html file-by-file.
* do ad-hoc email and irc messaging.
* clean up unused code.
* build parlay view
* bring in opentabs data
* debug and use in production for email, irc, opentabs

interface design:
=================
- one main stream of all notifications.
- message bodies and attachments separately
- flag this message / reply to this message
- mark whole page as read
- group emails into conversations based on inReplyTo thread-trees
- group irc msg into conversations based on channel or peer
- grouping email conversation based on forum is less important
- group gh issue comments with the issue as the conversation
- grouping gh issues per repo/state/milestone is important, but doesn't belong in Meute necessarily
- listing members of a conversation is important in irc
- for Twitter, each tweet is a new conversation unless it's a reply, so they would be over-represented. maybe make each twitter handle ('the people this handle follows') or search term a conversation
- for github search terms as conversations can also make sense
- need a better word for 'conversation'. 'chat'?
- it should only set the messages that were actually in the current view as 'read'. it's ok to just have 50 messages even it that's all just one thread
- on the readscreen, show a whole conversation instead of one msg.
- opentabs form like sms command:
  2000 INR by me for both #peter paid lunch