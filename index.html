<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <style>
      nav { width:20em; float:left }
      article { width:40em; float:left }
      article textarea { width: 40em; height: 20em }
    </style>
  </head>
  <body>
    <nav style="float:left" >
      <h2>Contacts:</h2>
      <a href="https://accounts.google.com/o/oauth2/auth?scope=https://www.google.com/m8/feeds&response_type=code&redirect_uri=http://localhost:8000/&approval_prompt=force&state=/profile&client_id=709507725318.apps.googleusercontent.com&hl=cs&from_login=1&as=-70afdc9022b91924&pli=1&authuser=0">import from Google</a>
      <table id="contactsList"></table>
    </nav>
    <article id="compose" style="display:none" >
      <h2>Compose:</h2>
      <textarea id="text"></textarea>
      <p>
        To:<input id="to" onkeyup="searchTo();" /><a id="suggestion" href="#"></a><input type="submit" value="Send" onclick="sendEmail();" />
      </p>
    </article>
    <article id="message" style="display:none" >
      <h2 id="convHead"></h2>
      <ul id="convList"></ul>
    </article>
    <article id="history" style="float:right" >
      <h2>History:</h2>
      <table id="history" border="1" ></table>
    </article>
  </body>
  <script src="remotestorage.js"> </script>
  <script src="sockjs-0.3.min.js"> </script>
  <script src="inbox.js"> </script>
  <script>
    remoteStorage.displayWidget();
    RemoteStorage.defineModule('contacts', function(privClient, pubClient) {
      return {
        exports: {
          add: function(address, attributes) {
            return privClient.storeObject('contact', address, JSON.stringify(attributes));
          },
          getList: function() {
            return privClient.getAll('');
          }
        }
      };
    });
    function searchTo() {
      var suggestion = search(document.getElementById('to').value);
      if(suggestion) {
        document.getElementById('suggestion').innerHTML=suggestion.name;
        document.getElementById('suggestion').onclick=function() {
          document.getElementById('to').value = suggestion.name+' <'+suggestion.address+'>';
        };
      }
    }
  </script>
  <script src="app.js"> </script>
</html>
