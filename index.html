<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Meute - a Solid chat app</title>
  </head>
  <body>
    <h1>v0.8</h1>
    <p style="width:30em" >Meute is still very basic.</p>
    <div id="login-state"></div>
    <input type="submit" value="Log in" onclick="login();">
    <input type="submit" value="Log out" onclick="logout();">
  </body>
  <script src="https://solid.github.io/solid-auth-client/dist/solid-auth-client.bundle.js"></script>
  <script>
  solid.auth.trackSession(session => {
    if (!session) {
      console.log('The user is not logged in');
      document.getElementById('login-state').innerHTML = 'Not logged in.';
    } else {
      console.log(`The user is ${session.webId}`);
      document.getElementById('login-state').innerHTML = `Logged in as ${session.webId}.`;
    }
  })
  function logout() {
    solid.auth.logout()
      .then(() => alert('Goodbye!'));
  }
  async function login() {
    let session = await solid.auth.currentSession();
    let popupUri = 'https://solid.community/common/popup.html';
    if (!session)
      session = await solid.auth.popupLogin({ popupUri });
    alert(`Logged in as ${session.webId}`);
  }
  </script>
</html>
